<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8" />
    <title>Karta Maszyny 2</title>
    <link rel="stylesheet" href="content.css" />
    <link rel="stylesheet" href="card2.css" />
</head>
<body>
<div class="card2-page">

    <div class="view-box">
        <span class="view-label">Opcje widoku</span>
        <div class="view-menu">
            <button class="view-btn" type="button">
                <img src="svg-folder/ListViewIcon.svg" alt="">
                <span>Lista</span>
            </button>
            <button class="view-btn" type="button">
                <img src="svg-folder/SchemeViewIcon.svg" alt="">
                <span>Schemat</span>
            </button>
            <button class="view-btn" type="button">
                <img src="svg-folder/CardViewIcon.svg" alt="">
                <span>Karta</span>
            </button>
        </div>
    </div>

    <div class="cardheader-box">
        <div class="cardheader-content">
            <span class="header-label">Karta Maszyny</span>
            <button id="namePrev" class="nav-btn" type="button">
                <img src="svg-folder/LeftIcon.svg" alt="" class="icon-16">
            </button>
            <select id="nameSelect" class="name-select">
                <option>Maszyna skrawająca 01</option>
                <option>Maszyna nieskrawająca 02</option>
                <option>Robot 1</option>
                <option>Robot 2</option>
                <option>Wózek widłowy</option>
            </select>
            <button id="nameNext" class="nav-btn" type="button">
                <img src="svg-folder/RightIcon.svg" alt="" class="icon-16">
            </button>
            <div class="header-actions">
                <button class="content-btn content-btn-activate" type="button">Edytuj</button>
                <button class="content-btn content-btn-add" type="button">Dodaj</button>
                <button class="content-btn content-btn-activate" type="button">Duplikuj</button>
            </div>
        </div>
    </div>

    <div class="main-panels">
        <div class="main-left">
            <div class="row-split-2">
            <div class="panel panel--tall">
                <span class="panel-label">Dane operacyjne</span>
                <div class="panel-content">
                    <div class="op-top-inline">
                        <div class="field">
                            <label for="statusSelect">Status</label>
                            <select id="statusSelect" class="status-select">
                                <option value="aktywny" class="status-open">aktywny</option>
                                <option value="nieaktywny" class="status-closed">nie aktywny</option>
                                <option value="usun" class="status-delete">usuń</option>
                            </select>
                        </div>
                        <div class="field">
                            <label for="opStatusSelect">Status operacyjny</label>
                            <select id="opStatusSelect" class="status-select">
                                <option>Zakupiona</option>
                                <option selected>Operacyjna</option>
                                <option>Rezerwa</option>
                                <option>Serwis</option>
                                <option>Wycofana</option>
                            </select>
                        </div>
                    </div>

                    <div class="cardheader-grid" style="grid-template-columns: 1fr; margin-top: 12px;">
                        <div class="field">
                            <label for="opParent">Maszyna nadrzędna</label>
                            <div class="option-row">
                                <img src="svg-folder/MachinesIcon.svg" alt="" class="icon-16">
                                <select id="opParent" class="select">
                                    <option>Robot A</option>
                                    <option>Robot B</option>
                                </select>
                                <button class="goto-btn" type="button">
                                    <span>Idź do maszyny</span>
                                    <img src="svg-folder/RightIcon.svg" alt="" class="icon-16">
                                </button>
                            </div>
                        </div>

                        <div class="field">
                            <label for="opLocation">Lokalizacja</label>
                            <div class="option-row">
                                <img src="svg-folder/LocationsIcon.svg" alt="" class="icon-16">
                                <select id="opLocation" class="select">
                                    <option>Hala 1</option>
                                    <option>Hala 2</option>
                                </select>
                                <button class="goto-btn" type="button">
                                    <span>Idź do lokalizacji</span>
                                    <img src="svg-folder/RightIcon.svg" alt="" class="icon-16">
                                </button>
                            </div>
                        </div>

                        <div class="field">
                            <label for="opDept">Wydział</label>
                            <div class="option-row">
                                <img src="svg-folder/DepartmentsIcon.svg" alt="" class="icon-16">
                                <select id="opDept" class="select">
                                    <option>Wydział maszyn</option>
                                    <option>Wydział robotów</option>
                                </select>
                                <button class="goto-btn" type="button">
                                    <span>Idź do wydziału</span>
                                    <img src="svg-folder/RightIcon.svg" alt="" class="icon-16">
                                </button>
                                <div class="notes-box" style="flex:1; min-width:240px;">
                                    <label for="notes" style="font-weight:700;">Uwagi</label>
                                    <textarea id="notes">Przykładowe uwagi dotyczące aktualizacji danych operacyjnych. Możesz tu wpisać dodatkowe informacje, które wymagają przekazania zespołowi lub zachowania w historii zmian. Tekst może być dowolnej długości, pole pozwala na wielowierszowy opis i można je swobodnie przewijać.</textarea>
                                </div>
                            </div>
                        </div>

                        <div class="field">
                            <label for="opOwnership">Własność</label>
                            <select id="opOwnership" class="select">
                                <option>Leasing</option>
                                <option>Własność</option>
                            </select>
                        </div>

                        <div class="field">
                            <label for="owner">Właściciel</label>
                            <input id="owner" type="text" class="select" />
                        </div>

                        <div class="field">
                            <label for="inventoryInput">Numer inwentarzowy</label>
                            <div class="number-control">
                                <input id="inventoryInput" class="number-input" type="number" value="1001" />
                                <button class="number-spin up" type="button" aria-label="Więcej">
                                    <img src="svg-folder/UpIcon.svg" alt="">
                                </button>
                                <button class="number-spin down" type="button" aria-label="Mniej">
                                    <img src="svg-folder/DownIcon.svg" alt="">
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel panel--tall">
                <span class="panel-label">Dane techniczne</span>
                <div class="panel-content">
                    <div class="tech-grid">
                        <div class="field">
                            <label for="prodManufacturer">Producent</label>
                            <input id="prodManufacturer" type="text" class="select" />
                        </div>
                        <div class="field">
                            <label for="prodModel">Model</label>
                            <input id="prodModel" type="text" class="select" />
                        </div>
                        <div class="field">
                            <label for="serialNumber">Numer seryjny</label>
                            <input id="serialNumber" type="number" class="select" />
                        </div>
                        <div class="field">
                            <label for="prodYear">Rok produkcji</label>
                            <div class="date-nav-wrap date-nav-wrap--year">
                                <button class="date-nav-btn date-nav-btn--left" type="button" aria-label="Poprzedni rok">
                                    <img src="svg-folder/LeftIcon.svg" alt="">
                                </button>
                                <input id="prodYear" class="date-nav-input" type="number" min="1900" max="2100" step="1" value="2024" placeholder="rrrr" />
                                <button class="date-nav-btn date-nav-btn--calendar" type="button" aria-label="Wybierz rok">
                                    <img src="svg-folder/CalendarIcon.svg" alt="">
                                </button>
                                <button class="date-nav-btn date-nav-btn--right" type="button" aria-label="Następny rok">
                                    <img src="svg-folder/RightIcon.svg" alt="">
                                </button>
                            </div>
                        </div>
                        <div class="field">
                            <label for="category">Kategoria</label>
                            <input id="category" type="text" class="select" />
                        </div>
                        <div class="field">
                            <label for="warrantyDate">Data gwarancji</label>
                            <div class="date-nav-wrap date-nav-wrap--date">
                                <button class="date-nav-btn date-nav-btn--left" type="button" aria-label="Poprzednia data">
                                    <img src="svg-folder/LeftIcon.svg" alt="">
                                </button>
                                <input id="warrantyDate" type="date" class="date-nav-input" />
                                <button class="date-nav-btn date-nav-btn--calendar" type="button" aria-label="Wybierz datę">
                                    <img src="svg-folder/CalendarIcon.svg" alt="">
                                </button>
                                <button class="date-nav-btn date-nav-btn--right" type="button" aria-label="Następna data">
                                    <img src="svg-folder/RightIcon.svg" alt="">
                                </button>
                            </div>
                            <span class="warranty-note">Do gwarancji pozostało: 2 miesiące, 6 dni</span>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>

        <div class="panel panel--tall panel-gallery">
            <span class="panel-label">Galeria</span>
            <div class="panel-content">
                <div class="gallery-grid">
                    <div class="gallery-item"><img src="pictures/m1_thumb.jpg" alt="Galeria 1"></div>
                    <div class="gallery-item"><img src="pictures/m2_thumb.jpg" alt="Galeria 2"></div>
                    <div class="gallery-item"><img src="pictures/m3_thumb.jpg" alt="Galeria 3"></div>
                    <div class="gallery-item"><img src="pictures/m4_thumb.jpg" alt="Galeria 4"></div>
                    <div class="gallery-item"><img src="pictures/m5_thumb.jpg" alt="Galeria 5"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Nawigacja nazwą (select + strzałki)
const nameSelect = document.getElementById("nameSelect");
const namePrev = document.getElementById("namePrev");
const nameNext = document.getElementById("nameNext");
function shiftName(delta) {
    if (!nameSelect) return;
    const len = nameSelect.options.length;
    if (len === 0) return;
    const idx = Math.max(0, Math.min(len - 1, nameSelect.selectedIndex));
    let next = idx + delta;
    if (next < 0) next = 0;
    if (next > len - 1) next = len - 1;
    nameSelect.selectedIndex = next;
    nameSelect.dispatchEvent(new Event("change", { bubbles: true }));
}
if (namePrev) namePrev.addEventListener("click", () => shiftName(-1));
if (nameNext) nameNext.addEventListener("click", () => shiftName(1));

const statusSelect = document.getElementById("statusSelect");
const opStatusSelect = document.getElementById("opStatusSelect");
function syncStatusClass() {
    if (!statusSelect) return;
    statusSelect.classList.remove("status-open","status-closed","status-delete");
    const val = statusSelect.value;
    if (val === "aktywny") statusSelect.classList.add("status-open");
    else if (val === "nieaktywny") statusSelect.classList.add("status-closed");
    else if (val === "usun") statusSelect.classList.add("status-delete");
}
if (statusSelect) {
    statusSelect.addEventListener("change", syncStatusClass);
    syncStatusClass();
}

// Powiązanie statusu operacyjnego ze statusem głównym
if (statusSelect && opStatusSelect) {
    opStatusSelect.addEventListener("change", () => {
        const opVal = opStatusSelect.value.toLowerCase();
        if (opVal === "operacyjna") {
            statusSelect.value = "aktywny";
        } else if (opVal === "rezerwa" || opVal === "serwis" || opVal === "wycofana") {
            statusSelect.value = "nieaktywny";
        }
        syncStatusClass();
    });
}

// Po wyborze statusu fokus i rozwinięcie statusu operacyjnego; zwinięcie po wyborze
if (statusSelect && opStatusSelect) {
    statusSelect.addEventListener("change", () => {
        opStatusSelect.focus();
        opStatusSelect.size = Math.min(opStatusSelect.options.length, 5);
    });
    opStatusSelect.addEventListener("change", () => {
        opStatusSelect.size = 0;
    });
}

const invInput = document.getElementById("inventoryInput");
const btnUp = document.querySelector(".number-spin.up");
const btnDown = document.querySelector(".number-spin.down");
function adjustInventory(delta) {
    if (!invInput) return;
    const current = parseInt(invInput.value, 10) || 0;
    invInput.value = current + delta;
}
if (btnUp) btnUp.addEventListener("click", () => adjustInventory(1));
if (btnDown) btnDown.addEventListener("click", () => adjustInventory(-1));

// Date/Year nav buttons
function attachNav(inputId, leftSel, rightSel, step = 1, isDate = false) {
    const input = document.getElementById(inputId);
    const left = document.querySelector(leftSel);
    const right = document.querySelector(rightSel);
    if (!input) return;

    function shift(delta) {
        if (isDate) {
            const val = input.value || new Date().toISOString().slice(0,10);
            const d = new Date(val);
            if (isNaN(d)) return;
            d.setDate(d.getDate() + delta);
            input.value = d.toISOString().slice(0,10);
        } else {
            const v = parseInt(input.value, 10) || 0;
            input.value = v + delta;
        }
    }

    if (left) left.addEventListener("click", () => shift(-step));
    if (right) right.addEventListener("click", () => shift(step));
}

attachNav("prodYear", ".date-nav-btn--left[aria-label='Poprzedni rok']", ".date-nav-btn--right[aria-label='Następny rok']", 1, false);
attachNav("warrantyDate", ".date-nav-btn--left[aria-label='Poprzednia data']", ".date-nav-btn--right[aria-label='Następna data']", 1, true);
</script>
</body>
</html>
